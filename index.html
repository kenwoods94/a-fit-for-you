<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Could This Be a Fit?</title>
  <style>
    :root { font-family: -apple-system, system-ui, Segoe UI, Roboto, Arial, sans-serif; line-height: 1.35; }
    body { margin: 0; background: #f6f7fb; color: #111; }
    .wrap { max-width: 860px; margin: 0 auto; padding: 28px 16px 60px; }
    .card { background: white; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,.07); padding: 18px; margin-bottom: 14px; }
    h1 { font-size: 22px; margin: 0 0 8px; }
    p { margin: 8px 0; color: #333; }
    .muted { color: #555; font-size: 13px; }
    .bar { height: 10px; background: #e8eaf3; border-radius: 999px; overflow: hidden; }
    .bar > div { height: 100%; width: 0%; background: #4f46e5; transition: width .25s ease; }
    .q { margin-top: 12px; }
    .q h2 { font-size: 16px; margin: 0 0 10px; }
    .opts { display: grid; gap: 8px; }
    label.opt { display: flex; gap: 10px; align-items: flex-start; padding: 10px; border: 1px solid #e6e7ef; border-radius: 12px; cursor: pointer; }
    label.opt:hover { border-color: #cfd2ff; }
    input[type="radio"] { margin-top: 2px; }
    textarea {
      width: 100%; box-sizing: border-box; padding: 10px 12px;
      border: 1px solid #e6e7ef; border-radius: 12px; font-size: 14px;
      min-height: 88px; resize: vertical;
    }
    .row { display: flex; gap: 10px; flex-wrap: wrap; }
    .btn {
      border: 0; border-radius: 12px; padding: 10px 14px; cursor: pointer;
      background: #111; color: white; font-weight: 600;
    }
    .btn.secondary { background: #eef0ff; color: #1f2a66; }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    .pill { display: inline-block; padding: 5px 10px; border-radius: 999px; font-size: 12px; font-weight: 700; }
    .green { background: #e8f8ee; color: #0b6b2c; }
    .yellow { background: #fff7e6; color: #7a4a00; }
    .red { background: #ffecec; color: #8b1b1b; }
    .result h2 { margin: 0 0 8px; }
    .kvs { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 10px; }
    .kv { border: 1px dashed #d7dbff; border-radius: 12px; padding: 10px; }
    .kv b { display:block; margin-bottom: 4px; }
    .footer { text-align: center; margin-top: 18px; }
    .small { font-size: 12px; color: #555; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Could this business be a fit?</h1>
      <p class="muted">
        Would you be open to a few quick questions so I can better understand what you’re looking for
        and whether this might be worth exploring together?
      </p>
      <div class="bar" aria-label="progress"><div id="bar"></div></div>
      <p class="muted" id="progressText">Question 1 of 12</p>
    </div>

    <div class="card q" id="questionCard"></div>
    <div class="card" id="resultCard" style="display:none;"></div>

    <div class="footer small">
      Tip: This page can submit responses to your Google Sheet when you click Submit.
    </div>
  </div>

<script>
  // Gentle / relational Version A with conditional question #6
  const questions = [
    {
      id: "why",
      title: "1) If an extra income stream actually helped, what would you want it to do for you?",
      type: "radio",
      options: [
        { label: "Create more breathing room each month", score: 2 },
        { label: "Help with debt payoff", score: 2 },
        { label: "Build savings / future options", score: 2 },
        { label: "Create more flexibility in life", score: 2 },
        { label: "I’m not totally sure yet—just exploring", score: 1 }
      ]
    },
    {
      id: "whyNow",
      title: "2) Why does now feel like a time you’d at least be open to looking at something?",
      type: "text",
      placeholder: "A sentence or two is perfect."
    },
    {
      id: "hours",
      title: "3) Realistically, how much time could you give to something if it felt like a good fit?",
      type: "radio",
      options: [
        { label: "Less than 1 hour/week", score: 0 },
        { label: "1–2 hours/week", score: 1 },
        { label: "3–5 hours/week", score: 2 },
        { label: "6–10 hours/week", score: 3 },
        { label: "I’m not sure yet", score: 1 }
      ]
    },
    {
      id: "season",
      title: "4) Which best describes your current season of life?",
      type: "radio",
      options: [
        { label: "Very full, but I can be consistent with the right plan", score: 3 },
        { label: "My schedule is unpredictable right now", score: 1 },
        { label: "I have some margin and want to use it wisely", score: 3 },
        { label: "I’m in a transition season and figuring things out", score: 2 }
      ]
    },
    {
      id: "pastExperience",
      title: "5) Have you ever tried anything for extra income or a side business before?",
      type: "radio",
      options: [
        { label: "Yes, and I had a good experience", score: 3 },
        { label: "Yes, but it wasn’t a great fit", score: 2 },
        { label: "I’ve tried a little, but not much", score: 2 },
        { label: "No, this would be new for me", score: 2 }
      ]
    },
    {
      id: "pastExperienceDetail",
      title: "6) If yes, what did you like—or not like—about it?",
      type: "text",
      placeholder: "Totally optional—just helpful context.",
      conditional: {
        dependsOn: "pastExperience",
        showIfIn: [
          "Yes, and I had a good experience",
          "Yes, but it wasn’t a great fit",
          "I’ve tried a little, but not much"
        ]
      },
      optional: true
    },
    {
      id: "goals12mo",
      title: "7) Looking ahead 12 months, what would you most like to be different?",
      type: "radio",
      options: [
        { label: "More financial margin", score: 3 },
        { label: "More flexibility with my schedule", score: 3 },
        { label: "More confidence / momentum", score: 2 },
        { label: "A clearer long-term plan", score: 2 },
        { label: "I’m not sure yet, but I know I want change", score: 2 }
      ]
    },
    {
      id: "followThrough",
      title: "8) When you start something new, what helps you follow through best?",
      type: "radio",
      options: [
        { label: "A simple plan", score: 2 },
        { label: "Encouragement / accountability", score: 2 },
        { label: "Learning with other people", score: 2 },
        { label: "Flexibility and room to go at my pace", score: 1 },
        { label: "Small wins early on", score: 1 }
      ]
    },
    {
      id: "sharingComfort",
      title: "9) How do you feel about sharing things you genuinely like with people you know?",
      type: "radio",
      options: [
        { label: "I enjoy that naturally", score: 3 },
        { label: "I’m comfortable when it feels authentic", score: 2 },
        { label: "I’m open to learning how", score: 2 },
        { label: "That feels uncomfortable for me right now", score: 0 }
      ]
    },
    {
      id: "avoidFeel",
      title: "10) If you were exploring something new, what would you not want it to feel like?",
      type: "radio",
      options: [
        { label: "High pressure", score: 1 },
        { label: "Too sales-y", score: 1 },
        { label: "Complicated / confusing", score: 2 },
        { label: "Time-heavy or rigid", score: 1 },
        { label: "Big upfront cost / inventory", score: 1 },
        { label: "Doing it alone without support", score: 2 }
      ]
    },
    {
      id: "supportStyle",
      title: "11) If you were learning something new, what kind of support would help you feel comfortable?",
      type: "radio",
      options: [
        { label: "One-on-one guidance", score: 3 },
        { label: "A simple step-by-step plan", score: 3 },
        { label: "Encouragement/community", score: 3 },
        { label: "Time to process and ask questions", score: 2 },
        { label: "A mix of all of the above", score: 3 }
      ]
    },
    {
      id: "readiness",
      title: "12) Based on where you are right now, which feels most true?",
      type: "radio",
      options: [
        { label: "I’d be open to taking a closer look", score: 3 },
        { label: "I’m curious and would want to ask a few questions first", score: 2 },
        { label: "I’m not sure yet, but I’m glad to learn more", score: 1 },
        { label: "It’s probably not the right timing for me right now", score: 0 }
      ]
    }
  ];

  let i = 0;
  const answers = {};

  const bar = document.getElementById("bar");
  const progressText = document.getElementById("progressText");
  const questionCard = document.getElementById("questionCard");
  const resultCard = document.getElementById("resultCard");

  function pct(n, d){ return d ? Math.round((n/d)*100) : 0; }

  function shouldShowQuestion(q) {
    if (!q.conditional) return true;
    const dep = q.conditional.dependsOn;
    const allowed = q.conditional.showIfIn || [];
    const depAnswer = answers[dep]?.value;
    return allowed.includes(depAnswer);
  }

  function visibleQuestions() {
    return questions.filter(shouldShowQuestion);
  }

  function clampIndex() {
    const total = visibleQuestions().length;
    if (i < 0) i = 0;
    if (i > Math.max(total - 1, 0)) i = Math.max(total - 1, 0);
  }

  function render() {
    const visible = visibleQuestions();
    clampIndex();
    const total = visible.length;
    const q = visible[i];

    bar.style.width = pct(i, total) + "%";
    progressText.textContent = `Question ${i+1} of ${total}`;

    const saved = answers[q.id]?.value ?? "";
    let html = `<h2>${q.title}</h2>`;

    if (q.type === "radio") {
      html += `<div class="opts" role="radiogroup" aria-label="${escapeAttr(q.title)}">`;
      q.options.forEach((opt) => {
        const checked = saved === opt.label ? "checked" : "";
        html += `
          <label class="opt">
            <input type="radio" name="${q.id}" value="${escapeAttr(opt.label)}" data-score="${opt.score}" ${checked}/>
            <div>${escapeHtml(opt.label)}</div>
          </label>
        `;
      });
      html += `</div>`;
    } else {
      html += `<textarea id="textInput" placeholder="${escapeAttr(q.placeholder || "")}">${escapeHtml(saved)}</textarea>`;
      if (q.optional) {
        html += `<p class="muted">Optional — you can leave this blank.</p>`;
      }
    }

    html += `
      <div class="row" style="margin-top:14px;">
        <button class="btn secondary" id="backBtn" ${i===0 ? "disabled" : ""}>Back</button>
        <button class="btn" id="nextBtn">${i === total-1 ? "See Results" : "Next"}</button>
        <button class="btn secondary" id="resetBtn" style="margin-left:auto;">Reset</button>
      </div>
      <p class="muted" style="margin-top:10px;">
        This is just a conversation tool to help with clarity — not a prediction of results.
      </p>
    `;

    questionCard.innerHTML = html;

    document.getElementById("backBtn").onclick = () => {
      if (i > 0) {
        i--;
        render();
      }
    };

    document.getElementById("resetBtn").onclick = () => {
      i = 0;
      for (const k in answers) delete answers[k];
      hideResults();
      render();
    };

    document.getElementById("nextBtn").onclick = () => {
      if (!saveAnswer(q)) return;

      // If Q5 changed and Q6 is no longer relevant, clear Q6 answer
      if (q.id === "pastExperience") {
        const q6 = questions.find(x => x.id === "pastExperienceDetail");
        if (q6 && !shouldShowQuestion(q6)) {
          delete answers["pastExperienceDetail"];
        }
      }

      const currentVisible = visibleQuestions();
      const currentTotal = currentVisible.length;

      if (i < currentTotal - 1) {
        i++;
        render();
      } else {
        showResults();
      }
    };
  }

  function saveAnswer(q) {
    if (q.type === "radio") {
      const sel = questionCard.querySelector(`input[name="${q.id}"]:checked`);
      if (!sel) {
        alert("Please choose an option to continue.");
        return false;
      }
      answers[q.id] = { value: sel.value, score: Number(sel.dataset.score || 0) };
      return true;
    }

    if (q.type === "text") {
      const txt = (document.getElementById("textInput").value || "").trim();
      if (!txt && !q.optional) {
        alert("Please type a short answer to continue.");
        return false;
      }
      answers[q.id] = { value: txt || "", score: 0 };
      return true;
    }

    return false;
  }

  function totalScore() {
    return Object.values(answers).reduce((sum, a) => sum + (a.score || 0), 0);
  }

  function maxPossibleScoreForCurrentAnswers() {
    // Based on currently visible questions, sum max score of each radio question
    return visibleQuestions().reduce((sum, q) => {
      if (q.type !== "radio") return sum;
      const max = Math.max(...q.options.map(o => Number(o.score || 0)));
      return sum + max;
    }, 0);
  }

  function buildPayload() {
    return {
      submittedAt: new Date().toISOString(),
      score: totalScore(),
      maxPossibleScore: maxPossibleScoreForCurrentAnswers(),
      answers: Object.fromEntries(Object.entries(answers).map(([k, v]) => [k, v.value]))
    };
  }

  function showResults() {
    questionCard.style.display = "none";
    resultCard.style.display = "block";
    bar.style.width = "100%";
    progressText.textContent = "Done";

    const score = totalScore();
    const maxScore = Math.max(maxPossibleScoreForCurrentAnswers(), 1);
    const ratio = score / maxScore;

    let label, pillClass, headline, nextStep;

    if (ratio >= 0.70) {
      label = "Explore";
      pillClass = "pill green";
      headline = "This looks worth exploring";
      nextStep = "There seems to be a good amount of alignment based on what you shared. A simple next step could be a short overview and a chance to ask questions.";
    } else if (ratio >= 0.45) {
      label = "Maybe";
      pillClass = "pill yellow";
      headline = "Could be a fit with a little more conversation";
      nextStep = "There may be a fit here, but it would help to talk through timing, expectations, and what kind of support would feel best.";
    } else {
      label = "Not right now";
      pillClass = "pill red";
      headline = "Probably not the right timing right now";
      nextStep = "That’s completely okay. This may not be the right season, and clarity is a win. You can always revisit later if your situation changes.";
    }

    const whyNow = answers.whyNow?.value || "(not answered)";
    const hours = answers.hours?.value || "(not answered)";
    const goals12mo = answers.goals12mo?.value || "(not answered)";
    const readiness = answers.readiness?.value || "(not answered)";
    const avoidFeel = answers.avoidFeel?.value || "(not answered)";

    resultCard.className = "card result";
    resultCard.innerHTML = `
      <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
        <span class="${pillClass}">${label}</span>
        <h2 style="margin:0;">${headline}</h2>
      </div>

      <p><b>What this means:</b> ${escapeHtml(nextStep)}</p>

      <div class="kvs">
        <div class="kv"><b>Your “why now”</b><div>${escapeHtml(whyNow)}</div></div>
        <div class="kv"><b>Time you said you have</b><div>${escapeHtml(hours)}</div></div>
        <div class="kv"><b>What you want different in 12 months</b><div>${escapeHtml(goals12mo)}</div></div>
        <div class="kv"><b>What you don’t want it to feel like</b><div>${escapeHtml(avoidFeel)}</div></div>
        <div class="kv"><b>Where you are right now</b><div>${escapeHtml(readiness)}</div></div>
      </div>

      <div class="row" style="margin-top:14px;">
        <button class="btn secondary" id="editBtn">Edit Answers</button>
        <button class="btn secondary" id="downloadBtn">Download (JSON)</button>
        <button class="btn" id="submitBtn">Submit</button>
      </div>
      <p class="muted" id="submitStatus" style="margin-top:10px;"></p>

      <p class="muted" style="margin-top:10px;">
        Reminder: This is directional and based only on the answers shared here.
      </p>
    `;

    document.getElementById("editBtn").onclick = () => {
      resultCard.style.display = "none";
      questionCard.style.display = "block";
      i = Math.max(visibleQuestions().length - 1, 0);
      render();
    };

    document.getElementById("downloadBtn").onclick = downloadJSON;
    document.getElementById("submitBtn").onclick = submitToSheet;
  }

  function hideResults() {
    questionCard.style.display = "block";
    resultCard.style.display = "none";
  }

  function downloadJSON() {
    const payload = buildPayload();
    const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "questionnaire-responses.json";
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(a.href);
  }

  async function submitToSheet() {
    const payload = buildPayload();

    const ENDPOINT = "https://script.google.com/macros/s/AKfycbw7Pru3IIjn-DPPTxHkYrgGwvacJKWK0fWDmfmBYoquyae33onfHwPYmoZhM-xoslrfcA/exec";

    const statusEl = document.getElementById("submitStatus");
    statusEl.textContent = "Submitting...";

    try {
      await fetch(ENDPOINT, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
      statusEl.textContent = "Submitted. Check your Google Sheet (Responses tab) in a few seconds.";
    } catch (err) {
      statusEl.textContent = "Submission failed. Please try again.";
      console.error(err);
    }
  }

  function escapeHtml(str) {
    return String(str)
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  function escapeAttr(str) {
    return String(str).replaceAll('"', "&quot;");
  }

  render();
</script>
</body>
</html>
